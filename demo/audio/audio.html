<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <input type="button" value="播放/暂停" onclick="pop()">
    <input type="button" value="加速" onclick="changeSpeed(0.25)">
    <input type="button" value="减速" onclick="changeSpeed(-0.25)">
    <input type="button" value="重播" onclick="replay()">
    <script src="audio.js"></script>
    <script src="laudio.js"></script>
    <script>
        var audio = laudio;
        function changeSpeed(speed){
            audio.changeSpeed(speed);
        };
        function pop(){
            if(!audio.hasplay){
                audio.play();
                return ;
            }
            if(audio.audioCtx.state === 'running') {
                audio.suspend();
            } else if(audio.audioCtx.state === 'suspended') {
                audio.resume();  
            }
        };
        function replay(){
            audio.replay();
            console.log(audio);
        };
        function addAudio(url,index) {
            var request = new XMLHttpRequest();
            request.open('GET', url, true);
            request.responseType = 'arraybuffer';

            // Decode asynchronously
            request.onload = function() {
                audio.audioCtx.decodeAudioData(request.response, function(buffer) {
                    dogBarkingBuffer = buffer;
                    audio.addAudio(dogBarkingBuffer,index);
                }, onError);
            }
            request.send();
        };
        function onError(){
            console.log('错了');
        };
        addAudio('https://127.0.0.1:12345/测试音频002.wav',1);
        addAudio('https://127.0.0.1:12345/2',2);
        addAudio('https://127.0.0.1:12345/3',3);
        addAudio('https://127.0.0.1:12345/4',4);
        addAudio('https://127.0.0.1:12345/1',5);
        addAudio('https://127.0.0.1:12345/2',6);
        addAudio('https://127.0.0.1:12345/3',7);
        addAudio('https://127.0.0.1:12345/4',8);
        console.log(audio);
    </script>
</body>
</html>